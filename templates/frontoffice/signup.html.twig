<?php


$fileToImport = "export-03-08-2022.csv";
$projectId = 1;

if (($handle = fopen($fileToImport, "r")) !== false) {

echo "INSERT INTO `site_newsletter_users_access` (`project_id`, `subscriber_email`, `is_active`, `is_wrong`, `created_at`, `updated_at`, `unsubscribe_token`) VALUES" . "<br>";

    while (($data = fgetcsv($handle, 1000, ",")) !== false) {

        $token = rtrim(strtr(base64_encode(random_bytes(32)), '+/', '-_'), '=');

        echo sprintf('(%s, "%s", 1, 0, "%s", "%s", "%s"),',
            $projectId,
            trim($data[0]),
            date("Y-m-d h:i:s"),
            date("Y-m-d h:i:s"),
            $token
        ) . "<br />";

    }
    fclose($handle);
}